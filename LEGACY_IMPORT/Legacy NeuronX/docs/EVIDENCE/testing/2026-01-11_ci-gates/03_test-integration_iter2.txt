PHASE 2 - FIXES ITERATION 2

Changes made:
- Fixed Security Guarantees tests to match correct controller signatures (removed extra mockRes parameter)
- Fixed mockRequest scoping in Security Guarantees block

Results: 6 tests passing, 3 failing
- All Security Guarantees tests now pass
- Remaining issues: 3 tests expecting rate limiting calls that aren't happening

Command: pnpm -w test:integration
Exit code: 1

Still failing. Need to fix the remaining 3 tests that expect rate limiting to be called.