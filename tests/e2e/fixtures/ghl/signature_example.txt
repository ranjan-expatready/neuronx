# GHL Webhook Signature Example

## Overview
This file documents the webhook signature format used for verifying GHL webhook authenticity.

## Signature Format
GHL webhooks use HMAC-SHA256 signatures in the format:
`sha256=<hmac_signature>`

Where `<hmac_signature>` is the base64-encoded HMAC digest.

## Generation Process
1. Take the raw JSON payload as a UTF-8 string
2. Compute HMAC-SHA256 using the webhook secret as the key
3. Base64 encode the resulting digest
4. Prefix with "sha256="

## Example Implementation (Node.js)
```javascript
const crypto = require('crypto');

function generateSignature(payload, secret) {
  const hmac = crypto.createHmac('sha256', secret);
  hmac.update(JSON.stringify(payload), 'utf8');
  const digest = hmac.digest('base64');
  return `sha256=${digest}`;
}
```

## Test Payload
Using the payload from webhook_lead_created.json with secret "test_webhook_secret":

Expected signature: sha256=ABC123... (actual signature would be computed)

## Verification Steps
1. Extract signature from `x-webhook-signature` header
2. Remove "sha256=" prefix to get the base64 digest
3. Compute HMAC-SHA256 of payload with webhook secret
4. Base64 encode the result
5. Compare with extracted digest using constant-time comparison

## Unknown Status
⚠️  GHL webhook signature algorithm needs verification against official documentation.
See docs/ghl_capability_map/14_VERIFICATION_CHECKLIST.md for verification steps.
